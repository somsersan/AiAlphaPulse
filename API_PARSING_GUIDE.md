# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø–∞—Ä—Å–∏–Ω–≥—É API –¥–∞–Ω–Ω—ã—Ö

## –ü—Ä–æ–±–ª–µ–º–∞
APIParser –Ω–µ –ø–∞—Ä—Å–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–¥–µ

**ParsingService** - –¥–æ–±–∞–≤–ª–µ–Ω async context manager:
```python
async def parse_api_data(self) -> int:
    if not self.api_parser:
        print("‚ö†Ô∏è API –ø–∞—Ä—Å–µ—Ä –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω")
        return 0
        
    try:
        print("üîÑ –ù–∞—á–∏–Ω–∞–µ–º –ø–∞—Ä—Å–∏–Ω–≥ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö...")
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º async context manager –¥–ª—è APIParser
        async with self.api_parser:
            articles = await self.api_parser.parse_crypto_data()
            print(f"üìä –ü–æ–ª—É—á–µ–Ω–æ {len(articles)} —Å—Ç–∞—Ç–µ–π –∏–∑ API")
            new_articles = await self._save_articles(articles, SourceType.API)
            print(f"‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ {new_articles} –Ω–æ–≤—ã—Ö —Å—Ç–∞—Ç–µ–π –æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞—Ö")
            return new_articles
```

**APIParser** - –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
```python
async def parse_crypto_data(self) -> List[Article]:
    try:
        print("üîÑ –ü–∞—Ä—Å–∏–Ω–≥ CoinGecko API...")
        coingecko_articles = await self._parse_coingecko_data()
        articles.extend(coingecko_articles)
        print(f"‚úÖ CoinGecko: –ø–æ–ª—É—á–µ–Ω–æ {len(coingecko_articles)} —Å—Ç–∞—Ç–µ–π")
        
        # ... –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –¥—Ä—É–≥–∏—Ö API
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞: {str(e)}")
        # –ù–µ –ø—Ä–µ—Ä—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
```

**main_new.py** - –¥–æ–±–∞–≤–ª–µ–Ω–∞ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
```python
result = loop.run_until_complete(parsing_service.parse_all_sources())
print(f"‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω. –î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç–∞—Ç–µ–π: {result.get('total', 0)}")
print(f"üìä –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è:")
print(f"   - RSS: {result.get('rss', 0)} —Å—Ç–∞—Ç–µ–π")
print(f"   - Telegram: {result.get('telegram', 0)} —Å—Ç–∞—Ç–µ–π")
print(f"   - API (–∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—ã): {result.get('api', 0)} —Å—Ç–∞—Ç–µ–π")
```

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –¢–µ—Å—Ç 1: –ë–∞–∑–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
python test_crypto_parser.py
```

#### –¢–µ—Å—Ç 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ParsingService
```bash
python test_main_integration.py
```

#### –¢–µ—Å—Ç 3: –†–µ–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ —Å –ë–î
```bash
python test_real_parsing.py
```

#### –¢–µ—Å—Ç 4: –¢–æ–ª—å–∫–æ API –ø–∞—Ä—Å–∏–Ω–≥
```bash
python test_api_parsing.py
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤—ã –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å –≤ –ª–æ–≥–∞—Ö:

```
üîÑ –ù–∞—á–∏–Ω–∞–µ–º –ø–∞—Ä—Å–∏–Ω–≥ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö...
üîÑ –ü–∞—Ä—Å–∏–Ω–≥ CoinGecko API...
‚úÖ CoinGecko: –ø–æ–ª—É—á–µ–Ω–æ 20 —Å—Ç–∞—Ç–µ–π
‚ö†Ô∏è CoinMarketCap API –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
üîÑ –ü–∞—Ä—Å–∏–Ω–≥ Binance API...
‚úÖ Binance: –ø–æ–ª—É—á–µ–Ω–æ 5 —Å—Ç–∞—Ç–µ–π
üìä –ü–æ–ª—É—á–µ–Ω–æ 25 —Å—Ç–∞—Ç–µ–π –∏–∑ API
‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ 25 –Ω–æ–≤—ã—Ö —Å—Ç–∞—Ç–µ–π –æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞—Ö
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

–ó–∞–ø—É—Å—Ç–∏—Ç–µ SQL –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
```sql
SELECT 
    source,
    category,
    COUNT(*) as count,
    MAX(created_at) as last_article
FROM articles 
WHERE source LIKE '%API%' 
   OR category = 'Cryptocurrency'
GROUP BY source, category
ORDER BY last_article DESC;
```

### 5. API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

- `GET /api/articles?source=CoinGecko API` - —Å—Ç–∞—Ç—å–∏ –∏–∑ CoinGecko
- `GET /api/articles?category=Cryptocurrency` - –≤—Å–µ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã–µ —Å—Ç–∞—Ç—å–∏
- `GET /api/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞

## üîß –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î
**–ü—Ä–∏—á–∏–Ω–∞**: APIParser –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç async context manager
**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ ParsingService

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –û—à–∏–±–∫–∏ —Å–µ—Ç–∏
**–ü—Ä–∏—á–∏–Ω–∞**: API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –∏–ª–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, –ø–∞—Ä—Å–∏–Ω–≥ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–µ–π
**–ü—Ä–∏—á–∏–Ω–∞**: –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ú–µ–¥–ª–µ–Ω–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥
**–ü—Ä–∏—á–∏–Ω–∞**: –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
**–†–µ—à–µ–Ω–∏–µ**: ‚úÖ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å aiohttp

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤—ã –¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å:

1. **CoinGecko**: 15-20 —Å—Ç–∞—Ç–µ–π –æ —Ç–æ–ø –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞—Ö
2. **Binance**: 5 —Å—Ç–∞—Ç–µ–π –æ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä–∞—Ö
3. **CoinMarketCap**: 15-20 —Å—Ç–∞—Ç–µ–π (–µ—Å–ª–∏ –µ—Å—Ç—å API –∫–ª—é—á)

**–ò—Ç–æ–≥–æ**: 20-45 —Å—Ç–∞—Ç–µ–π –æ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞—Ö –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–∞—Ä—Å–∏–Ω–≥–µ

## üöÄ –ó–∞–ø—É—Å–∫

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `aiohttp`:
   ```bash
   pip install aiohttp==3.9.1
   ```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
   ```bash
   python main_new.py
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ –ø–∞—Ä—Å–∏–Ω–≥–µ API

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è —Å—Ç–∞—Ç—å–∏ —Å `source` —Å–æ–¥–µ—Ä–∂–∞—â–∏–º "API"

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–î–æ–±–∞–≤—å—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
```python
# –í settings.py
crypto:
  update_interval: 5  # –º–∏–Ω—É—Ç
  top_cryptocurrencies: [...]  # —Å–ø–∏—Å–æ–∫ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç
```

–ü–∞—Ä—Å–∏–Ω–≥ –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –≤–º–µ—Å—Ç–µ —Å RSS –∏ Telegram.

